<!DOCTYPE html>
<html>

<head>
    <title></title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
    <style>
        rect {
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <%for(var i = 1; i <=4; i++){%>
    <div id='R<%=i%>' style="margin: 0; border-width: 10px; border-color: black; border-style: dashed; display: inline-block;">
        <h2>R<%=i%></h2>
        <div id='RA<%=i%>' style="height: 500px; ;width: 500px; float: left; background-color: black;"></div>
        <div id='RB<%=i%>' style="height: 500px; ;width: 500px; float: left; background-color: blue;"></div>
        <div id='RC<%=i%>' style="height: 500px; ;width: 500px; float: left; background-color : gold"></div>
        <div id='X<%=i%>' style="height: 500px; ;width: 500px; float: left; background-color : white"></div>
        <div id='Y<%=i%>' style="height: 500px; ;width: 500px; float: left; background-color: black;"></div>
    </div>
    <%}%>

        <script type="text/javascript">
            var layout = {
                datarevision: 'true',
                uirevision: 'true',
                xaxis: { autorange: true },
                yaxis: { autorange: true }
            };
            function initPlot(id) {
                var data = [
                    {
                        x: [0],
                        y: [0],
                        type: 'bar'
                    }
                ];
                Plotly.react(id, data, layout);
            }
            for (var i = 1; i <= 4; i++) {
                initPlot('RA' + i)
                initPlot('RB' + i)
                initPlot('RC' + i)
                initPlot('X' + i)
                initPlot('Y' + i)
            }

            var drawPlot = function (data) {
                var num
                if (data.id[1] == '1')
                    num = 'RA'
                else if (data.id[1] == '2')
                    num = 'RB'
                else if (data.id[1] == '3')
                    num = 'RC'
                else if (data.id[1] == '4')
                    num = 'X'
                else if (data.id[1] == '5')
                    num = 'Y'
                var id = num + data.id[0]
                layout.datarevision = !layout.datarevision
               
                Plotly.react(id, data.data, layout)
            }


            function updateData() {
                for (var i = 1; i <= 4; i++) {
                    for (var j = 1; j <= 5; j++) {
                        $.post("http://localhost:3000/toPlot/", { "ID": i, 'NUM': j }, function (data) {

                            if (data.data[0].x != 'NaN')
                                drawPlot(data)
                        }, "json");
                    }
                }
            }
            updateData()
            timerID = setInterval("updateData()", 2000);

        </script>
</body>

</html>